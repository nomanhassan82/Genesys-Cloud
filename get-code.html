<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Google OAuth â€“ Get Access Token (Client Only)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    body{font-family:system-ui,Arial,sans-serif;margin:24px;max-width:720px}
    label{display:block;margin:.6rem 0 .3rem;font-weight:600}
    input,button{padding:.65rem .8rem;border:1px solid #bbb;border-radius:10px}
    input{width:100%}
    button{cursor:pointer;margin-right:8px}
    pre{white-space:pre-wrap;word-break:break-all;background:#f4f4f4;padding:12px;border-radius:10px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .muted{opacity:.75}
  </style>
</head>
<body>
  <h1>Get Google <code>access_token</code> (Client-only)</h1>

  <label for="clientId">Google OAuth Client ID</label>
  <input id="clientId" placeholder="YOUR_CLIENT_ID.apps.googleusercontent.com" />

  <div class="row">
    <div>
      <label for="scopes">Scopes (space-separated)</label>
      <input id="scopes" value="openid email profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile" />
    </div>
    <div>
      <label for="prompt">Prompt</label>
      <input id="prompt" value="consent" />
    </div>
  </div>

  <div style="margin-top:12px">
    <button id="getToken">Get access token</button>
    <button id="callApi" disabled>Call UserInfo API</button>
  </div>

  <h3 style="margin-top:18px">Result</h3>
  <pre id="out">(no token yet)</pre>

  <script>
    let tokenClient, accessToken;

    function log(obj) {
      const out = document.getElementById('out');
      out.textContent = typeof obj === 'string' ? obj : JSON.stringify(obj, null, 2);
    }

    window.onload = () => {
      document.getElementById('getToken').onclick = async () => {
        const client_id = document.getElementById('clientId').value.trim();
        const scope = document.getElementById('scopes').value.trim();
        const prompt = document.getElementById('prompt').value.trim();

        if (!client_id) { alert('Enter your Client ID'); return; }

        tokenClient = google.accounts.oauth2.initTokenClient({
          client_id,
          scope,
          prompt, // "consent" forces the consent screen; "" lets Google decide
          callback: (resp) => {
            if (resp.error) { log(resp); return; }
            accessToken = resp.access_token;
            document.getElementById('callApi').disabled = !accessToken;
            log({ access_token: accessToken, expires_in: resp.expires_in, token_type: resp.token_type, scope: resp.scope });
          },
        });

        tokenClient.requestAccessToken(); // will pop a Google prompt if needed
      };

      document.getElementById('callApi').onclick = async () => {
        if (!accessToken) return;
        const r = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
          headers: { Authorization: `Bearer ${accessToken}` }
        });
        const data = await r.json();
        log(data);
      };
    };
  </script>
</body>
</html>
